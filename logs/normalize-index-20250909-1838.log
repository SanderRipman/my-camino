**********************
PowerShell transcript start
Start time: 20250909183830
Username: SANDER360\Sander
RunAs User: SANDER360\Sander
Configuration Name: 
Machine: SANDER360 (Microsoft Windows NT 10.0.26100.0)
Host Application: C:\Program Files\PowerShell\7\pwsh.dll -WorkingDirectory ~
Process ID: 4416
PSVersion: 7.5.2
PSEdition: Core
GitCommitId: 7.5.2
OS: Microsoft Windows 10.0.26100
Platform: Win32NT
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1, 6.0, 7.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
WSManStackVersion: 3.0
**********************
PS C:\Dev\my-camino> # 1) Backup av index
PS C:\Dev\my-camino> if (Test-Path $Index) { Copy-Item $Index "$Index.bak-$ts" -Force }
PS C:\Dev\my-camino> # 2) Normaliser index: behold siste snapshot pr ChatKey
PS C:\Dev\my-camino> if (Test-Path $Index) {
    $lines = Get-Content $Index
    $header = $lines | Select-String '^# ' -Context 0,2
    $table  = $lines | Where-Object { $_ -match '^\|' -and $_ -notmatch '^#' }
    $entries = $table | ForEach-Object {
        if ($_ -match '^\|\s*(\S+)\s*\|\s*([\d-]+\s[\d:]+)\s*\|\s*(.+)\|$') {
            [PSCustomObject]@{
                ChatKey   = $matches[1]
                Timestamp = [datetime]$matches[2]
                Zip       = $matches[3].Trim()
                Raw       = $_
            }
        }
    }
    $latest = $entries | Sort-Object ChatKey,Timestamp | Group-Object ChatKey | ForEach-Object {
        $_.Group | Sort-Object Timestamp -Descending | Select-Object -First 1
    }
    $newTable = $latest | Sort-Object ChatKey | ForEach-Object {
        "| {0,-15} | {1,-16:yyyy-MM-dd HH:mm} | {2} |" -f $_.ChatKey,$_.Timestamp,$_.Zip
    }
    $out = @()
    $out += "# AidMe – Handover-oversikt"
    $out += "| ChatKey       | Sist oppdatert       | ZIP-sti |"
    $out += "|---------------|----------------------|---------|"
    $out += $newTable
    Set-Content -Path $Index -Value $out -Encoding UTF8
    Write-Host "✅ Index normalisert: beholdt siste snapshot pr ChatKey" -ForegroundColor Green
}
✅ Index normalisert: beholdt siste snapshot pr ChatKey
PS C:\Dev\my-camino> # 3) Fix skrivebordssnarvei
PS C:\Dev\my-camino> $ShortcutDir = [Environment]::GetFolderPath('Desktop')
PS C:\Dev\my-camino> $LnkPath     = Join-Path $ShortcutDir 'Aid Control Center (PS7).lnk'
PS C:\Dev\my-camino> $ps7         = (Get-Command pwsh.exe -ErrorAction SilentlyContinue | Select-Object -First 1).Source
PS C:\Dev\my-camino> if (-not $ps7) { $ps7 = "$env:ProgramFiles\PowerShell\7\pwsh.exe" }
PS C:\Dev\my-camino> $inner = "Set-Location '$Root'; if (Get-Command ctrl -ErrorAction SilentlyContinue) { ctrl } else { Write-Host 'Hint: ctrl ikke funnet – sjekk Cheatsheet.ps1' -ForegroundColor Yellow }"
PS C:\Dev\my-camino> $Args  = "-NoLogo -NoProfile -NoExit -Command `"$inner`""
PS C:\Dev\my-camino> $WScriptShell = New-Object -ComObject WScript.Shell
PS C:\Dev\my-camino> if(Test-Path $LnkPath){ Remove-Item $LnkPath -Force }
PS C:\Dev\my-camino> $Shortcut = $WScriptShell.CreateShortcut($LnkPath)
PS C:\Dev\my-camino> $Shortcut.TargetPath       = $ps7
PS C:\Dev\my-camino> $Shortcut.Arguments        = $Args
>> TerminatingError(): "Exception setting "Arguments": Cannot convert the "System.Object[]" value of type "Object[]" to type "string"."
Exception setting "Arguments": Cannot convert the "System.Object[]" value of type "Object[]" to type "string".
ParentContainsErrorRecordException: Exception setting "Arguments": Cannot convert the "System.Object[]" value of type "Object[]" to type "string".
PS C:\Dev\my-camino> $Shortcut.WorkingDirectory = $Root
PS C:\Dev\my-camino> $Shortcut.IconLocation     = "$ps7,0"
PS C:\Dev\my-camino> $Shortcut.Save()
PS C:\Dev\my-camino> Stop-Transcript | Out-Null
**********************
PowerShell transcript end
End time: 20250909183830
**********************
